<?xml version="1.0" standalone="no"?>

<kickstart>

<description>
Provides partial pre-execution environment (PXE) support for frontend machines.
</description>

        <copyright>
        Copyright (c) 2000 - 2014 The Regents of the University of California.
        All rights reserved. Rocks(r) 6.2 www.rocksclusters.org
        
        </copyright>

<changelog>

</changelog>

<post>
mkdir -p /tftpboot/pxelinux/pxelinux.cfg
chown root.apache /tftpboot/pxelinux/pxelinux.cfg
chmod 775 /tftpboot/pxelinux/pxelinux.cfg
</post>

<post cond="rocks_version_major == 6">

<!-- now setup the global PXE boot default actions -->
/opt/rocks/bin/rocks add bootaction action="install" \
	kernel="vmlinuz-&version;-&arch;" \
	ramdisk="initrd.img-&version;-&arch;" \
	args="ks ramdisk_size=150000 lang= devfs=nomount pxe kssendmac selinux=0 noipv6 ksdevice=bootif"

/opt/rocks/bin/rocks add bootaction action="os" \
	kernel="localboot 0"

/opt/rocks/bin/rocks add bootaction action="install headless" \
	kernel="vmlinuz-&version;-&arch;" \
	ramdisk="initrd.img-&version;-&arch;" \
	args="ks ramdisk_size=150000 lang= devfs=nomount pxe kssendmac selinux=0 noipv6 headless vnc ksdevice=bootif"

</post>

<post cond="rocks_version_major == 7">

<!-- now setup the global PXE boot default actions -->
/opt/rocks/bin/rocks add bootaction action="install" \
	kernel="vmlinuz-&version;-&arch;" \
	ramdisk="initrd.img-&version;-&arch;" \
	args="inst.ks.sendmac lang= devfs=nomount selinux=0 ipv6.disable=1 rocks=client ksdevice=bootif inst.repo=http://&Kickstart_PrivateKickstartHost;/&Kickstart_PrivateKickstartBasedir;/rocks-dist/&arch; inst.ks=http://&Kickstart_PrivateKickstartHost;/&Kickstart_PrivateKickstartBasedir;/&Kickstart_PrivateKickstartCGI; inst.updates=http://&Kickstart_PrivateAddress;/&Kickstart_PrivateKickstartBasedir;/rocks-dist/&arch;/images/updates.img inst.sshd"

/opt/rocks/bin/rocks add bootaction action="os" \
	kernel="localboot 0"

/opt/rocks/bin/rocks add bootaction action="install headless" \
	kernel="vmlinuz-&version;-&arch;" \
	ramdisk="initrd.img-&version;-&arch;" \
	args="headless inst.ks.sendmac pxe lang= devfs=nomount selinux=0 ipv6.disable=1 rocks=client ksdevice=bootif inst.repo=http://&Kickstart_PrivateKickstartHost;/&Kickstart_PrivateKickstartBasedir;/rocks/&arch; inst.ks=http://&Kickstart_PrivateKickstartHost;/&Kickstart_PrivateKickstartBasedir;/&Kickstart_PrivateKickstartCGI; inst.updates=http://&Kickstart_PrivateAddress;/&Kickstart_PrivateKickstartBasedir;/rocks-dist/&arch;/images/updates.img inst.sshd"
</post>
</kickstart> 

